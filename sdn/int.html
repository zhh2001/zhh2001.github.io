<!DOCTYPE html>
<html lang="zh-Hans" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>P4 INT | 张恒华</title>
    <meta name="description" content="张恒华的个人网站，存放学习笔记与个人简历。研究领域为软件定义网络、可编程数据平面。This is Henghua Zhang's personal website, where study notes and a resume are stored. The research focus is on SDN (Software-Defined Networking) and PDP (Programmable Data Plane).">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.DU1xIe2k.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.FiTZ8u4i.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Mx95tLgp.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BZemHgQ6.js">
    <link rel="modulepreload" href="/assets/sdn_int.md.C7K9HRcg.lean.js">
    <meta name="keywords" content="张恒华, 笔记, 学习笔记, 科研笔记, 读书笔记, 阅读笔记, 文献阅读, 论文阅读, 软件定义网络, 可编程数据平面, Go语言, Go协程, Go开发, SDN控制器, SDN仿真实验, SDN网络监控, Henghua Zhang, Software Defined Network, Software-Defined Networking, SDN, Programmable Data Plane, PDP, Programming Protocol-independent Packet Processors, P4, INT, In-band Network Telemetry, OpenFlow, Mininet, iPerf, Scapy, Ryu, Go, GoLang, RPC, gRPC, Goroutine, Gin">
    <meta name="google-site-verification" content="wMOTcBwCiCMV7ESftQRY3Glvq8UL4xzUKrZ-1wjOpqM">
    <link rel="icon" href="/sues.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&amp;display=swap" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-414XCQ3MDV"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-414XCQ3MDV");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>张恒华</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>首页</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>学习笔记</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>SDN</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/p4" data-v-35975db6><!--[--><span data-v-35975db6>P4 Language</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/p4_exercise" data-v-35975db6><!--[--><span data-v-35975db6>P4 Exercise</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link active" href="/sdn/int" data-v-35975db6><!--[--><span data-v-35975db6>P4 INT</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/p4_utils" data-v-35975db6><!--[--><span data-v-35975db6>P4 Utils</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/mininet" data-v-35975db6><!--[--><span data-v-35975db6>Mininet</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/iperf" data-v-35975db6><!--[--><span data-v-35975db6>iPerf</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/reading/" data-v-35975db6><!--[--><span data-v-35975db6>Reading</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/writing/" data-v-35975db6><!--[--><span data-v-35975db6>Writing</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/ccf" data-v-35975db6><!--[--><span data-v-35975db6>CCF</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/sdn/journal" data-v-35975db6><!--[--><span data-v-35975db6>Journal</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Go</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/go/golang" data-v-35975db6><!--[--><span data-v-35975db6>GoLang</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/go/goroutine" data-v-35975db6><!--[--><span data-v-35975db6>Goroutine</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/go/gin" data-v-35975db6><!--[--><span data-v-35975db6>Gin</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/go/grpc" data-v-35975db6><!--[--><span data-v-35975db6>gRPC</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/resume" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>关于我</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://blog.csdn.net/qq_43133192" aria-label="csdn" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-csdn"></span></a><a class="VPSocialLink no-icon" href="https://github.com/zhh2001" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="mailto:1652709417@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-qq"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>主题</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://blog.csdn.net/qq_43133192" aria-label="csdn" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-csdn"></span></a><a class="VPSocialLink no-icon" href="https://github.com/zhh2001" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="mailto:1652709417@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-qq"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>菜单</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>回到顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 is-link has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/" data-v-b3fd67f8><!--[--><h2 class="text" data-v-b3fd67f8>SDN</h2><!--]--></a><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/p4" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>P4 Language</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/p4_exercise" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>P4 Exercise</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/int" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>P4 INT</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/p4_utils" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>P4 Utils</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/mininet" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Mininet</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/iperf" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>iPerf</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/" data-v-b3fd67f8><!--[--><h3 class="text" data-v-b3fd67f8>Reading</h3><!--]--></a><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/paper" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>SDN Paper</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h4 class="text" data-v-b3fd67f8>SDN Monitoring</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/apam" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>APAM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/lint" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>DLINT & PINT</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/FlowStalker" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>FlowStalker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/fapm" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>FAPM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/FS-INT" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>FS-INT</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/marina" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Marina</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/reading/monitoring/ppm" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>PPM</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><section class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/writing/" data-v-b3fd67f8><!--[--><h3 class="text" data-v-b3fd67f8>Writing</h3><!--]--></a><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/writing/formula" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Formula</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/writing/algorithm" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Algorithm</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/writing/table" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Table</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/writing/bibliography" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/ccf" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>CCF</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/sdn/journal" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Journal</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Go</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/go/golang" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>GoLang</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/go/goroutine" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Goroutine</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/go/gin" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Gin</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/go/grpc" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>gRPC</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>页面导航</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _sdn_int" data-v-39a288b8><div><h1 id="p4-int" tabindex="-1">P4 INT <a class="header-anchor" href="#p4-int" aria-label="Permalink to &quot;P4 INT&quot;">​</a></h1><p>带内网络遥测（In-band Network Telemetry，简称 INT）</p><h2 id="_1-引言" tabindex="-1">1 引言 <a class="header-anchor" href="#_1-引言" aria-label="Permalink to &quot;1 引言&quot;">​</a></h2><p>INT 是一种无需控制平面干预即可由数据平面直接采集和上报网络状态的框架。在 INT 架构中，数据包中可以携带由网络设备解释为“遥测指令”的特殊报文头字段。INT 流量的生成端（包括应用程序、终端主机网络协议栈、虚拟机管理器、网卡、发送端的顶层汇聚交换机等）可以将这些指令嵌入普通数据包、克隆数据包，或专门构造的探测包中。另一种方式是直接在数据平面中预设规则，对匹配的流量自动执行指定的遥测指令。</p><p>这些指令的作用是明确告知支持 INT 功能的网络设备需要收集哪些状态信息。所采集的网络状态可由数据平面直接导出至遥测监控系统，或在数据包转发过程中动态写入包头。当状态信息以嵌入形式随数据包在网络中传播时，流量接收端便可提取这些信息，并按需上报，从而实现对数据包实际经过路径中数据平面状态的精确监控。</p><p>流量接收端可根据具体需求执行以下几类典型操作：</p><ul><li><strong>运维监控（OAM）</strong>：<a href="#sink">接收端</a>可提取并上报嵌入的数据平面状态，上传至外部控制器。这些信息可以是未经处理的原始数据，也可进行初步加工，例如压缩、去重或截断。</li><li><strong>实时控制与反馈机制</strong>：接收端可基于采集的遥测信息，向流量源反馈控制信号，驱动其进行流量工程调整或转发路径优化。例如，显式拥塞通知（ECN）机制就是一种典型的反馈控制手段。</li><li><strong>网络事件检测</strong>：若路径状态表明存在严重拥塞或违反某些数据平面不变量的情况，<a href="#sink">接收端</a>可立即触发响应动作，以应对当前的网络事件。这类响应可以是集中式的，也可以是类似 TCP 的全分布式反馈控制。</li></ul><div class="tip custom-block"><p class="custom-block-title"><span id="sink">接收端 sink</span></p><p>虽然这些操作通常由接收端节点（Sink nodes）完成，但中继节点（Transit nodes）也可能会发起运维管理（OAM）操作，或执行网络事件检测。</p></div><p>INT 架构模型具有高度的通用性，能够支持多种高层次的网络应用场景，包括但不限于以下几类：</p><ul><li><strong>网络故障排查与性能监测</strong>：例如路径追踪（Traceroute）、微突发检测（micro-burst detection）以及数据包历史记录（又称为“<a href="#postcards">明信片</a>”机制）。<div class="info custom-block"><p class="custom-block-title"><span id="postcards">明信片 postcards</span></p><p>Handigol, Nikhil, Brandon Heller, Vimalkumar Jeyakumar, David Mazières, and Nick McKeown. &quot;I know what your packet did last hop: Using packet histories to troubleshoot networks.&quot; In 11th USENIX Symposium on Networked Systems Design and Implementation (NSDI 14), pp. 71-85. 2014.</p></div></li><li><strong>高级拥塞控制策略</strong>：利用实时遥测数据进行更灵敏和精准的拥塞响应与调节。</li><li><strong>智能路由机制</strong>：如基于链路利用率感知的路由方法，代表性方案包括 <a href="#HULA">HULA</a> 和 <a href="#CLOVE">CLOVE</a> 等。<div class="info custom-block"><p class="custom-block-title"><span id="HULA">HULA</span></p><p>Naga Katta, Mukesh Hira, Changhoon Kim, Anirudh Sivaraman, and Jennifer Rexford. 2016. HULA: Scalable Load Balancing Using Programmable Data Planes. In Proceedings of the Symposium on SDN Research (SOSR &#39;16). Association for Computing Machinery, New York, NY, USA, Article 10, 1–12. <a href="https://doi.org/10.1145/2890955.2890968" target="_blank" rel="noreferrer">https://doi.org/10.1145/2890955.2890968</a></p></div><div class="info custom-block"><p class="custom-block-title"><span id="CLOVE">CLOVE</span></p><p>Naga Katta, Aditi Ghag, Mukesh Hira, Isaac Keslassy, Aran Bergman, Changhoon Kim, and Jennifer Rexford. 2017. Clove: Congestion-Aware Load Balancing at the Virtual Edge. In Proceedings of the 13th International Conference on emerging Networking EXperiments and Technologies (CoNEXT &#39;17). Association for Computing Machinery, New York, NY, USA, 323–335. <a href="https://doi.org/10.1145/3143361.3143401" target="_blank" rel="noreferrer">https://doi.org/10.1145/3143361.3143401</a></p></div></li><li><strong>数据平面验证</strong>：通过遥测信息对网络数据平面的行为与一致性进行验证。</li></ul><p>上述应用的具体用例及评估可参考《<a href="#Millions_of_Little_Minions">Millions of Little Minions</a>》一文中的详细论述。</p><div class="info custom-block"><p class="custom-block-title"><span id="Millions_of_Little_Minions">Millions of Little Minions</span></p><p>Vimalkumar Jeyakumar, Mohammad Alizadeh, Yilong Geng, Changhoon Kim, and David Mazières. 2014. Millions of little minions: using packets for low latency network programming and visibility. In Proceedings of the 2014 ACM conference on SIGCOMM (SIGCOMM &#39;14). Association for Computing Machinery, New York, NY, USA, 3–14. <a href="https://doi.org/10.1145/2619239.2626292" target="_blank" rel="noreferrer">https://doi.org/10.1145/2619239.2626292</a></p></div><h2 id="_2-术语说明" tabindex="-1">2 术语说明 <a class="header-anchor" href="#_2-术语说明" aria-label="Permalink to &quot;2 术语说明&quot;">​</a></h2><p><strong>监控系统（Monitoring System）</strong>：负责收集来自不同网络设备的遥测数据的系统。该系统的组件在物理上可能是分布式的，但逻辑上应视为集中统一的实体。</p><p><strong>INT 报文头（INT Header）</strong>：用于携带 INT 信息的数据包头部，主要分为三类：嵌入数据类型（MD-type）、嵌入指令类型（MX-type）和目标类型（Destination-type），具体定义参见<a href="#sec51">第 5.1 节</a>。</p><p><strong>INT 报文（INT Packet）</strong>：携带 INT 报文头的数据包。</p><p><strong>INT 节点（INT Node）</strong>：具备 INT 功能的网络设备，参与 INT 数据平面操作，并执行如下至少一项任务：插入、附加、移除或处理 INT 报文头中的指令。根据部署情境，典型的 INT 节点包括路由器、交换机、网卡等。</p><p><strong>INT 指令（INT Instruction）</strong>：用于指定在各 INT 节点处需采集哪些 INT 元数据（定义见下文）的遥测指令。该指令可通过配置 INT 节点中的流监控表（Flow Watchlist）进行设置，或直接写入数据包的 INT 报文头中。</p><p><strong>流监控表（Flow Watchlist）</strong>：位于数据平面中的一张匹配表，基于数据包头字段进行匹配，对命中的流执行相应的 INT 指令插入或应用操作。一个流通常指具有相同关键字段值的一组数据包。</p><p><strong>INT 源（INT Source）</strong>：受信任的实体，负责生成并插入 INT 报文头至其发送的数据包中。可通过配置流监控表来选择哪些流应嵌入 INT 报文头。</p><p><strong>INT 接收端（INT Sink）</strong>：受信任的实体，负责从数据包中提取 INT 报文头，收集其中包含的路径状态信息，并在必要时将该报文头移除，以确保 INT 对上层协议透明。值得注意的是，这并不排除在多级或嵌套 INT 域中部署接收端。INT Sink 可将提取的数据上报至遥测监控系统。</p><p><strong>INT 中继跳点（INT Transit Hop）</strong>：受信任的实体，根据 INT 指令从数据平面中采集元数据。数据既可直接导出至监控系统，也可写入数据包的 INT 报文头中。</p><p>需要指出的是，一个物理设备在同一或不同流上可能同时承担多个角色，如 INT 源、中继、接收端。例如，某 INT 源节点可将自身元数据嵌入数据包，因而在逻辑上也充当了中继跳点的角色。</p><p><strong>INT 元数据（INT Metadata）</strong>：由 INT 源节点或中继节点插入至 INT 报文头或遥测报告中的信息。典型元数据示例详见第 4 节。</p><p><strong>INT 域（INT Domain）</strong>：由一组处于同一管理体系下、互联的 INT 节点构成的域。当前规范定义了不同厂商设备在同一 INT 域内交互时的行为规范与报文头格式，以保障互操作性。域内所有 INT 节点需进行一致性配置，建议在域边界部署 INT 接收端能力，以防止遥测信息泄露至域外。</p><h2 id="_3-int-的运行模式" tabindex="-1">3 INT 的运行模式 <a class="header-anchor" href="#_3-int-的运行模式" aria-label="Permalink to &quot;3 INT 的运行模式&quot;">​</a></h2><p>自 INT 于 2015 年在 P4.org 社区首次提出以来，其架构已衍生出多种变体，并在 IETF 及业界社区中持续被探讨与演进。同时，“INT”这一术语也逐渐被广义使用，用以泛指所有基于数据平面的遥测方法，而不再仅限于最初提出的“经典 INT”模式——即在数据包中同时嵌入遥测指令与元数据的方式。</p><p>为此，依据数据包所经历的修改程度，特别是嵌入内容的不同，对 INT 的运行模式进行分类与定义。下文将详细介绍各类运行模式，并在<a href="#fig1">图 1</a> 中进行汇总展示。</p><p id="fig1" align="center"><img width="95%" src="/int/fig1.png" alt="Various modes of INT operation."><span>图 1. INT 操作的各种模式</span></p><h3 id="_3-1-int-应用模式" tabindex="-1">3.1 INT 应用模式 <a class="header-anchor" href="#_3-1-int-应用模式" aria-label="Permalink to &quot;3.1 INT 应用模式&quot;">​</a></h3><p>在 INT 应用场景中，原始数据包将被监测，并可能被修改以携带遥测指令和元数据。根据对数据包修改的程度不同，INT 模式可分为以下三类：</p><ul><li><p><strong>INT-XD（eXport Data，导出数据）模式</strong>：INT 节点根据其流监控表（Flow Watchlist）中配置的 INT 指令，从数据平面中直接导出元数据至遥测监控系统，无需对数据包本身进行任何修改。<br> 该模式在早期遥测报告规范中也被称为“明信片（Postcard）”模式，灵感来源于 <a href="#handigol2014know">Handigol 等人</a>提出的机制。</p><div class="info custom-block"><p class="custom-block-title"><span id="handigol2014know">明信片 postcards</span></p><p>Handigol, Nikhil, Brandon Heller, Vimalkumar Jeyakumar, David Mazières, and Nick McKeown. &quot;I know what your packet did last hop: Using packet histories to troubleshoot networks.&quot; In 11th USENIX Symposium on Networked Systems Design and Implementation (NSDI 14), pp. 71-85. 2014.</p></div></li><li><p><strong>INT-MX（eMbed instructions，嵌入指令）模式</strong>：在此模式下，INT 源节点将遥测指令嵌入数据包头中。随后，INT 源节点、中继节点（Transit）以及接收节点（Sink）依据这些嵌入的指令，分别将采集到的元数据直接发送至遥测监控系统。接收端在转发前会移除指令报文头，以确保对后续处理的透明性。<br> 此模式下，对数据包的修改仅限于插入遥测指令头部，因此即便数据包经过多个中继节点，其长度也不会不断增长。<br> INT-MX 亦支持“源端插入”元数据作为域特定指令（Domain-Specific Instructions）的一部分，使得源节点可嵌入额外元数据，供其他节点或监控系统使用。<br> 此模式的设计灵感来自 <a href="#IOAM">IOAM 提出的“直接导出（Direct Export）”机制</a>。</p><div class="info custom-block"><p class="custom-block-title"><span id="IOAM">IOAM</span></p><p>F. Brockners, S. Bhandari, and T. Mizrahi. 2022. RFC 9197: Data Fields for In Situ Operations, Administration, and Maintenance (IOAM). RFC Editor, USA.</p><p>H. Song, B. Gafni, F. Brockners, S. Bhandari, and T. Mizrahi. 2022. RFC 9326: In Situ Operations, Administration, and Maintenance (IOAM) Direct Exporting. RFC Editor, USA.</p></div></li><li><p><strong>INT-MD（eMbed Data，嵌入数据）模式</strong>：该模式是经典的逐跳遥测方式，数据包中同时嵌入遥测指令与采集的元数据。其具体流程为：</p><ol><li>INT 源节点嵌入遥测指令；</li><li>源节点及各中继节点依照指令将本地元数据写入数据包中；</li><li>INT 接收端移除数据包中的指令及聚合后的元数据，并视需要将结果发送至监控系统。</li></ol><p>在三种模式中，INT-MD 对数据包的修改程度最大，但由于所有遥测信息集中封装在报文中传递，因此监控系统无需从多个节点分别聚合遥测报告，从而大幅降低系统端的处理负载。<br> 自 INT 规范 2.0 版本起，INT-MD 模式也引入了“仅源端插入”元数据的能力，作为域特定指令的一部分，使源节点可嵌入附加遥测数据，供接收端或监控系统解析使用。</p></li></ul><div class="warning custom-block"><p class="custom-block-title">注意</p><p>除非特别说明，后续内容均默认采用 INT-MD 模式作为基础运行模式。</p></div><h3 id="_3-2-int-在合成流量中的应用" tabindex="-1">3.2 INT 在合成流量中的应用 <a class="header-anchor" href="#_3-2-int-在合成流量中的应用" aria-label="Permalink to &quot;3.2 INT 在合成流量中的应用&quot;">​</a></h3><p>INT 源节点可以通过克隆原始数据包或生成特定的探测包（probe packet）来创建携带 INT 标记的合成流量（Synthetic Traffic）。对于这类合成流量，所有中继节点均应以与处理常规流量完全相同的方式应用 INT 操作。</p><p>合成流量与真实业务流量之间的主要区别在于：INT 接收节点在提取完路径中收集到的遥测数据后，通常需要丢弃合成流量，而非继续将其转发。为实现这一机制，INT 报文头中的 D 位（Discard Bit） 可被用作标识，表明对应数据包为克隆包或探测包，并应在 INT Sink 节点被丢弃。</p><p>所有 INT 模式均可应用于此类合成或探测数据包，具体模式由 INT 源节点决定。其中，若将 INT-MD（嵌入数据）模式 应用于探测包，则可实现与 <a href="#IFA">IFA</a> 类似的遥测功能。</p><div class="info custom-block"><p class="custom-block-title"><span id="IFA">IFA</span></p><div class="language-bibtex vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bibtex</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@techreport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kumar-ippm-ifa-08</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">draft-kumar-ippm-ifa-08</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Internet-Draft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    institution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Internet Engineering Task Force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    publisher</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Internet Engineering Task Force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    note</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Work in Progress</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =       </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https://datatracker.ietf.org/doc/draft-kumar-ippm-ifa/08/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =     </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{Inband Flow Analyzer}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    pagetotal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">33</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    month</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =       </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></div><p>通常而言，由克隆操作生成的合成流量在到达 INT Sink 后将被丢弃，而探测包则可依据具体用途被设置为转发或丢弃。正确标记这些数据包以明确接收端行为（转发或丢弃）是 INT 源节点的职责，确保 INT Sink 节点在完成遥测数据提取后作出正确处理。</p><h2 id="_4-监测内容的定义" tabindex="-1">4 监测内容的定义 <a class="header-anchor" href="#_4-监测内容的定义" aria-label="Permalink to &quot;4 监测内容的定义&quot;">​</a></h2><p>从理论上讲，INT 方法可用于定义并采集任意设备内部状态信息。然而在实际部署中，更具可行性和通用性的是确定一组精简的基础元数据集合，该集合可在多种网络设备上实现并广泛使用。本节所列出的元数据即构成了这样的基础集合。随着 INT 规范的不断演进，预计该集合将持续扩展，新增更多遥测字段以满足日益增长的需求。</p><p>需要注意的是，以下各类元数据的精确定义（例如时间戳的单位、跳延迟的计算方式、队列占用量或缓冲区使用率的量化方式等）可能因设备架构差异、功能集限制或资源约束等多种因素而有所不同。</p><p>相反，默认在具体部署过程中，各类 INT 设备的元数据语义应通过带外机制（Out-of-Band）与数据解释或分析组件进行协商与共享，从而确保遥测数据能被准确解析与应用。</p><h3 id="_4-1-设备级信息" tabindex="-1">4.1 设备级信息 <a class="header-anchor" href="#_4-1-设备级信息" aria-label="Permalink to &quot;4.1 设备级信息&quot;">​</a></h3><ul><li><p><strong>节点 ID（Node ID）</strong></p><p>表示 INT 节点的唯一标识符，通常由网络管理员进行配置。该标识在 INT 域内必须具备唯一性，用于在遥测报告中标明数据来源的设备节点。</p></li></ul><h3 id="_4-2-入接口信息" tabindex="-1">4.2 入接口信息 <a class="header-anchor" href="#_4-2-入接口信息" aria-label="Permalink to &quot;4.2 入接口信息&quot;">​</a></h3><ul><li><p><strong>入接口标识符（Ingress Interface Identifier）</strong></p><p>表示 INT 数据包被接收时所在的接口。一个数据包可能通过一系列接口结构堆栈进入设备，该堆栈通常起始于物理端口。例如，数据包可能首先被接收于某个物理端口，该端口隶属于链路聚合组，该聚合组又作为三层交换虚拟接口的一部分，同时该数据包在三层还可能处于隧道封装状态。</p><p>尽管理论上可以监测整个接口堆栈，但建议最多监测两个层级的入接口标识符：</p><ul><li>第一层级用于识别接收数据包的物理端口，占用 16 位（即一个 4 字节元数据字段的一半）；</li><li>第二层级用于识别逻辑接口，占用完整的 4 字节字段，32 位空间足以支持每个网络设备上的大量逻辑接口。</li></ul><p>需要注意的是，不同设备的接口标识符语义可能存在差异，每个 INT 节点可自行决定在两个层级中选择何种类型的接口进行报告。</p></li><li><p><strong>入接口时间戳（Ingress Timestamp）</strong></p><p>记录数据包在设备入方向（物理或逻辑接口）被接收时的本地时间。</p></li></ul><h3 id="_4-3-出接口信息" tabindex="-1">4.3 出接口信息 <a class="header-anchor" href="#_4-3-出接口信息" aria-label="Permalink to &quot;4.3 出接口信息&quot;">​</a></h3><ul><li><p><strong>出接口标识符（Egress Interface Identifier）</strong></p><p>表示 INT 数据包发送时所使用的接口。数据包可能从一组接口结构堆栈中被转发出去，该堆栈最终连接至物理端口。例如，数据包可能通过隧道传出，经过三层交换虚拟接口，再经过链路聚合组中的某个物理端口。</p><p>类似地，建议最多记录两个层级的出接口标识符：</p><ul><li>第一层级表示具体的物理端口，占用 16 位；</li><li>第二层级用于逻辑接口，占用 32 位空间，以支持丰富的接口层次。</li></ul><p>每个 INT 节点可根据设备实际结构与配置，自主选择在每一层级中报告的接口类型。</p></li><li><p><strong>出接口时间戳（Egress Timestamp）</strong></p><p>表示数据包在设备出方向（物理或逻辑端口）被处理或发送的本地时间。</p></li><li><p><strong>跳延迟（Hop Latency）</strong></p><p>表示数据包在本设备内从接收至转发所经历的处理时延。</p></li><li><p><strong>出接口链路利用率（Egress Interface TX Link Utilization）</strong></p><p>表示数据包被发送时，出接口的实时带宽利用情况。设备可使用不同方法来估算此利用率，例如时间桶计数法或滑动平均算法等。尽管滑动平均效果优于时间桶计数法，INT 框架并不限定具体实现方式，由设备厂商自行决定。</p></li><li><p><strong>队列占用量（Queue Occupancy）</strong></p><p>表示数据包在转发过程中观察到的出队列内积压的流量量，可采用字节数、单元数或包数等不同计量单位。该元数据字段为 4 字节，其具体格式与单位依赖于设备实现。YANG 模型中的元数据语义定义应描述该字段的编码方式与度量单位。</p></li><li><p><strong>缓冲区占用量（Buffer Occupancy）</strong></p><p>表示数据包在转发过程中观察到的缓冲区中的积压流量情况，适用于多个队列共享缓冲区的场景。该字段也是 4 字节长度，格式与队列占用量类似，由实现决定具体含义，需由元数据语义模型进行说明。</p></li></ul><p>目前，IETF 正在制定一套<a href="#yang">基于 YANG 的元数据语义模型</a>，用于支持网络设备报告其所采集元数据的格式、单位及语义定义，从而提升 INT 报告的可解释性与互操作性。</p><div class="info custom-block"><p class="custom-block-title"><span id="yang">YANG model</span></p><p>p4-dtel-metadata-semantics, <a href="https://github.com/p4lang/p4-applications/blob/master/telemetry/code/models/p4-dtel-metadata-semantics.yang" target="_blank" rel="noreferrer">https://github.com/p4lang/p4-applications/blob/master/telemetry/code/models/p4-dtel-metadata-semantics.yang</a></p></div><h2 id="_5-int-头部格式" tabindex="-1">5 INT 头部格式 <a class="header-anchor" href="#_5-int-头部格式" aria-label="Permalink to &quot;5 INT 头部格式&quot;">​</a></h2><p>本节主要讲 INT 头部（INT Headers）的格式与位置，适用于 INT-MX 与 INT-MD 模式。这两种模式下，INT 指令（在 MD 模式下还包括元数据栈）被嵌入至数据包中，因此需要在数据平面对 INT 头部进行处理。</p><h3 id="sec51" tabindex="-1">5.1 INT 头部类型 <a class="header-anchor" href="#sec51" aria-label="Permalink to &quot;5.1 INT 头部类型 {#sec51}&quot;">​</a></h3><p>INT 头部分为三种类型：<strong>MD 类型</strong>、<strong>MX 类型</strong>与 <strong>Destination 类型</strong>。每个 INT 数据包可能携带 MD 或 MX 类型中的一种头部，以及/或者 Destination 类型的头部。当同时存在 Destination 与 MD/MX 类型头部时，MD 或 MX 类型头部必须位于 Destination 类型头部之前。</p><ul><li><p><strong>MD 类型头部（INT Header Type 1）</strong></p><p>此类型的头部需要由中间节点（即 INT Transit Hop）进行处理。其详细格式将在第 5.8 节中讲解。</p></li><li><p><strong>Destination 类型头部（INT Header Type 2）</strong></p><p>此类型头部仅由 INT Sink 节点处理，中间节点必须忽略该头部内容。该类型头部用于支持 INT 源节点与终节点之间的边缘到边缘（Edge-to-Edge）通信。例如：</p><ul><li>INT 源节点可添加序列号，以检测 INT 数据包是否丢失；</li><li>INT 源节点可写入原始 IP TTL 值与 INT 剩余跳数（Remaining Hop Count），INT Sink 可通过对比 TTL 与剩余跳数的递减值，检测路径中是否存在不支持 INT 的网络设备（假设每个设备都是 L3 跳点）。</li></ul><p>Destination 类型头部的具体格式将在未来版本的规范中定义。值得注意的是，某些边缘到边缘的 INT 用例也可通过 MD 或 MX 类型头部中的“仅源节点插入（source-only）”或“源节点嵌入（source-inserted）”的领域专用指令（Domain Specific Instructions）加以实现。</p></li><li><p><strong>MX 类型头部（INT Header Type 3）</strong></p><p>此类型头部也需由中间节点进行处理，节点应根据其中嵌入的指令将指定元数据报告至监控系统。MX 类型头部的详细格式将在第 5.9 节中说明。</p></li></ul><h3 id="_5-2-每跳节点的头部操作" tabindex="-1">5.2 每跳节点的头部操作 <a class="header-anchor" href="#_5-2-每跳节点的头部操作" aria-label="Permalink to &quot;5.2 每跳节点的头部操作&quot;">​</a></h3><h4 id="_5-2-1-int-源节点-int-source-node" tabindex="-1">5.2.1 INT 源节点（INT Source Node） <a class="header-anchor" href="#_5-2-1-int-源节点-int-source-node" aria-label="Permalink to &quot;5.2.1 INT 源节点（INT Source Node）&quot;">​</a></h4><p>在 INT-MD 和 INT-MX 模式下，位于数据包转发路径起点的 INT 源节点负责创建相应的 INT-MD 或 INT-MX 头部。</p><p>在 INT-MD 模式中，源节点在生成头部后，需附加自身的 INT 元数据。为防止因转发环路或其他异常导致的头部空间耗尽，强烈建议通过适当设置 INT 头部中的 <strong>剩余跳数（Remaining Hop Count）</strong> 字段，限制后续 Transit Hop 节点添加的总元数据字段数量。</p><p>INT-MD 与 INT-MX 头部的具体结构将在后续章节中详细描述。</p><h4 id="_5-2-2-int-中继节点-int-transit-hop-node" tabindex="-1">5.2.2 INT 中继节点（INT Transit Hop Node） <a class="header-anchor" href="#_5-2-2-int-中继节点-int-transit-hop-node" aria-label="Permalink to &quot;5.2.2 INT 中继节点（INT Transit Hop Node）&quot;">​</a></h4><p>在 INT-MD 模式中，路径上的每个转发节点会<strong>按需动态扩展</strong> INT-MD 头部，以添加本节点的 INT 元数据。同样地，为避免由于环路或其他异常情况导致头部空间耗尽，每个 Transit Hop 节点必须<strong>适当递减“剩余跳数”字段的值</strong>。</p><p>在 INT-MX 模式中，每个 Transit Hop 节点依据 INT-MX 头部中嵌入的指令执行相应操作：收集本节点的特定元数据，并通过遥测报告（Telemetry Report）方式将其导出。</p><p>Transit Hop 节点可以修改 INT-MD 或 INT-MX 头部中的 DS Flags 字段，<strong>但不得修改</strong>以下字段：</p><ul><li>Hop ML（Hop Metadata Length）</li><li>Instruction Bitmap</li><li>Domain Specific ID</li><li>DS Instruction</li></ul><h4 id="_5-2-3-int-汇聚节点-int-sink-node" tabindex="-1">5.2.3 INT 汇聚节点（INT Sink Node） <a class="header-anchor" href="#_5-2-3-int-汇聚节点-int-sink-node" aria-label="Permalink to &quot;5.2.3 INT 汇聚节点（INT Sink Node）&quot;">​</a></h4><p>在 INT-MD 模式下，INT Sink 节点负责<strong>剥离</strong>数据包中的 INT 头部与元数据栈，并决定是否将收集到的信息上报。</p><p>在 INT-MX 模式下，INT Sink 节点<strong>移除</strong> INT-MX 头部，收集本地元数据，并决定是否对这些数据进行报告。</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/sdn/p4_exercise" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>上一页</span><span class="title" data-v-e257564d>P4 Exercise</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/sdn/p4_utils" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>下一页</span><span class="title" data-v-e257564d>P4 Utils</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>基于 <a href="/mit">MIT 许可</a> 发布</p><p class="copyright" data-v-e315a0ad>版权所有 © 2024至今 <a href="/resume">张恒华</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"go_gin.md\":\"D9_pkVr3\",\"go_golang.md\":\"Cc8JziQL\",\"go_goroutine.md\":\"BRlgDyqW\",\"go_grpc.md\":\"Jv-u3pVb\",\"index.md\":\"CshyPjUN\",\"mit.md\":\"DqO-MsrT\",\"public_readme.md\":\"DyuNFhSU\",\"resume.md\":\"BkFPksQ5\",\"sdn_ccf.md\":\"Dcvo25LR\",\"sdn_codes_advanced_tunnel_p4.md\":\"DUVgoyx_\",\"sdn_codes_basic_p4.md\":\"BVuK9uGu\",\"sdn_codes_basic_tunnel_p4.md\":\"D3dVWjsh\",\"sdn_codes_mycontroller_py.md\":\"C49PI03e\",\"sdn_codes_mytunnel_header_py.md\":\"DFaB9BzV\",\"sdn_codes_v1model_p4.md\":\"5NkBsWnb\",\"sdn_index.md\":\"6TVEAksB\",\"sdn_int.md\":\"C7K9HRcg\",\"sdn_iperf.md\":\"i1YiBdTR\",\"sdn_journal.md\":\"Dyp5WIQS\",\"sdn_mininet.md\":\"yHb8pkJ1\",\"sdn_p4.md\":\"BL939M64\",\"sdn_p4_exercise.md\":\"DfGilh5z\",\"sdn_p4_utils.md\":\"DzWuFmgm\",\"sdn_reading_index.md\":\"6Ge0L3Px\",\"sdn_reading_monitoring_apam.md\":\"Ca4qmb-e\",\"sdn_reading_monitoring_fapm.md\":\"B68DMqUX\",\"sdn_reading_monitoring_flowstalker.md\":\"Dfc6JBzL\",\"sdn_reading_monitoring_fs-int.md\":\"B7xk1C7j\",\"sdn_reading_monitoring_lint.md\":\"Dogpb_9l\",\"sdn_reading_monitoring_marina.md\":\"FLFl1h1t\",\"sdn_reading_monitoring_ppm.md\":\"CniypK8y\",\"sdn_reading_paper.md\":\"YcnxzcdP\",\"sdn_writing_algorithm.md\":\"BM2pIWjW\",\"sdn_writing_bibliography.md\":\"HHUsDl5O\",\"sdn_writing_formula.md\":\"DhbHgMn9\",\"sdn_writing_index.md\":\"CRUVlcGm\",\"sdn_writing_table.md\":\"Bo6aaMK9\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-Hans\",\"dir\":\"ltr\",\"title\":\"张恒华\",\"description\":\"张恒华的个人网站，存放学习笔记与个人简历。研究领域为软件定义网络、可编程数据平面。This is Henghua Zhang's personal website, where study notes and a resume are stored. The research focus is on SDN (Software-Defined Networking) and PDP (Programmable Data Plane).\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"siteTitle\":\"张恒华\",\"outlineTitle\":\"页面导航\",\"darkModeSwitchLabel\":\"主题\",\"lightModeSwitchTitle\":\"切换到浅色模式\",\"darkModeSwitchTitle\":\"切换到深色模式\",\"sidebarMenuLabel\":\"菜单\",\"returnToTopLabel\":\"回到顶部\",\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"footer\":{\"message\":\"基于 <a href=\\\"/mit\\\">MIT 许可</a> 发布\",\"copyright\":\"版权所有 © 2024至今 <a href=\\\"/resume\\\">张恒华</a>\"},\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"学习笔记\",\"items\":[{\"text\":\"SDN\",\"items\":[{\"text\":\"P4 Language\",\"link\":\"/sdn/p4\"},{\"text\":\"P4 Exercise\",\"link\":\"/sdn/p4_exercise\"},{\"text\":\"P4 INT\",\"link\":\"/sdn/int\"},{\"text\":\"P4 Utils\",\"link\":\"/sdn/p4_utils\"},{\"text\":\"Mininet\",\"link\":\"/sdn/mininet\"},{\"text\":\"iPerf\",\"link\":\"/sdn/iperf\"},{\"text\":\"Reading\",\"link\":\"/sdn/reading/\",\"items\":[{\"text\":\"SDN Paper\",\"link\":\"/sdn/reading/paper\"},{\"text\":\"SDN Monitoring\",\"collapsed\":true,\"items\":[{\"text\":\"APAM\",\"link\":\"/sdn/reading/monitoring/apam\"},{\"text\":\"DLINT & PINT\",\"link\":\"/sdn/reading/monitoring/lint\"},{\"text\":\"FlowStalker\",\"link\":\"/sdn/reading/monitoring/FlowStalker\"},{\"text\":\"FAPM\",\"link\":\"/sdn/reading/monitoring/fapm\"},{\"text\":\"FS-INT\",\"link\":\"/sdn/reading/monitoring/FS-INT\"},{\"text\":\"Marina\",\"link\":\"/sdn/reading/monitoring/marina\"},{\"text\":\"PPM\",\"link\":\"/sdn/reading/monitoring/ppm\"}]}]},{\"text\":\"Writing\",\"link\":\"/sdn/writing/\",\"items\":[{\"text\":\"Formula\",\"link\":\"/sdn/writing/formula\"},{\"text\":\"Algorithm\",\"link\":\"/sdn/writing/algorithm\"},{\"text\":\"Table\",\"link\":\"/sdn/writing/table\"},{\"text\":\"Bibliography\",\"link\":\"/sdn/writing/bibliography\"}]},{\"text\":\"CCF\",\"link\":\"/sdn/ccf\"},{\"text\":\"Journal\",\"link\":\"/sdn/journal\"}]},{\"text\":\"Go\",\"items\":[{\"text\":\"GoLang\",\"link\":\"/go/golang\"},{\"text\":\"Goroutine\",\"link\":\"/go/goroutine\"},{\"text\":\"Gin\",\"link\":\"/go/gin\"},{\"text\":\"gRPC\",\"link\":\"/go/grpc\"}]}]},{\"text\":\"关于我\",\"link\":\"/resume\"}],\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\"},\"modal\":{\"displayDetails\":\"显示详细内容\",\"resetButtonTitle\":\"清除查询条件\",\"noResultsText\":\"无法找到相关结果\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\"}}}}},\"sidebar\":[{\"text\":\"SDN\",\"link\":\"/sdn/\",\"items\":[{\"text\":\"P4 Language\",\"link\":\"/sdn/p4\"},{\"text\":\"P4 Exercise\",\"link\":\"/sdn/p4_exercise\"},{\"text\":\"P4 INT\",\"link\":\"/sdn/int\"},{\"text\":\"P4 Utils\",\"link\":\"/sdn/p4_utils\"},{\"text\":\"Mininet\",\"link\":\"/sdn/mininet\"},{\"text\":\"iPerf\",\"link\":\"/sdn/iperf\"},{\"text\":\"Reading\",\"link\":\"/sdn/reading/\",\"items\":[{\"text\":\"SDN Paper\",\"link\":\"/sdn/reading/paper\"},{\"text\":\"SDN Monitoring\",\"collapsed\":true,\"items\":[{\"text\":\"APAM\",\"link\":\"/sdn/reading/monitoring/apam\"},{\"text\":\"DLINT & PINT\",\"link\":\"/sdn/reading/monitoring/lint\"},{\"text\":\"FlowStalker\",\"link\":\"/sdn/reading/monitoring/FlowStalker\"},{\"text\":\"FAPM\",\"link\":\"/sdn/reading/monitoring/fapm\"},{\"text\":\"FS-INT\",\"link\":\"/sdn/reading/monitoring/FS-INT\"},{\"text\":\"Marina\",\"link\":\"/sdn/reading/monitoring/marina\"},{\"text\":\"PPM\",\"link\":\"/sdn/reading/monitoring/ppm\"}]}]},{\"text\":\"Writing\",\"link\":\"/sdn/writing/\",\"items\":[{\"text\":\"Formula\",\"link\":\"/sdn/writing/formula\"},{\"text\":\"Algorithm\",\"link\":\"/sdn/writing/algorithm\"},{\"text\":\"Table\",\"link\":\"/sdn/writing/table\"},{\"text\":\"Bibliography\",\"link\":\"/sdn/writing/bibliography\"}]},{\"text\":\"CCF\",\"link\":\"/sdn/ccf\"},{\"text\":\"Journal\",\"link\":\"/sdn/journal\"}]},{\"text\":\"Go\",\"items\":[{\"text\":\"GoLang\",\"link\":\"/go/golang\"},{\"text\":\"Goroutine\",\"link\":\"/go/goroutine\"},{\"text\":\"Gin\",\"link\":\"/go/gin\"},{\"text\":\"gRPC\",\"link\":\"/go/grpc\"}]}],\"notFound\":{\"code\":\"404\",\"linkText\":\"返回首页\",\"quote\":\"请检查页面路径是否正确\",\"title\":\"页面未找到\"},\"socialLinks\":[{\"icon\":\"csdn\",\"link\":\"https://blog.csdn.net/qq_43133192\"},{\"icon\":\"github\",\"link\":\"https://github.com/zhh2001\"},{\"icon\":\"qq\",\"link\":\"mailto:1652709417@qq.com\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>