import{_ as h,D as e,o as p,c as k,k as i,a as s,I as t,w as l,R as n}from"./chunks/framework._QHn8SP1.js";const d="/assets/Innodb.8Olcqls6.png",v=JSON.parse('{"title":"MySQL 学习笔记","description":"","frontmatter":{"prev":false},"headers":[],"relativePath":"notes/MySQL.md","filePath":"notes/MySQL.md"}'),r={name:"notes/MySQL.md"},E=n('<h1 id="mysql-学习笔记" tabindex="-1">MySQL 学习笔记 <a class="header-anchor" href="#mysql-学习笔记" aria-label="Permalink to &quot;MySQL 学习笔记&quot;">​</a></h1><h2 id="sql" tabindex="-1">SQL <a class="header-anchor" href="#sql" aria-label="Permalink to &quot;SQL&quot;">​</a></h2><table><thead><tr><th>分类</th><th style="text-align:left;">全称</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td>DDL</td><td style="text-align:left;">Data Definition Language</td><td style="text-align:left;">数据定义语言，用来定义数据库对象（数据库、表、字段）</td></tr><tr><td>DML</td><td style="text-align:left;">Data Manipulation Language</td><td style="text-align:left;">数据操作语言，用来对数据库表中的数据进行增删改</td></tr><tr><td>DQL</td><td style="text-align:left;">Data Query Language</td><td style="text-align:left;">数据查询语句，用来查询数据空中表的记录</td></tr><tr><td>DCL</td><td style="text-align:left;">Data Control Language</td><td style="text-align:left;">数据控制语句，用来创建数据库用户、控制数据库访问权限</td></tr></tbody></table><h2 id="ddl-数据库操作" tabindex="-1">DDL-数据库操作 <a class="header-anchor" href="#ddl-数据库操作" aria-label="Permalink to &quot;DDL-数据库操作&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW DATABASES;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [IF NOT EXISITS] </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`database_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [DEFAULT CHARSET `charset`] [COLLATE `collate`];</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [IF EXISTS] </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`database_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">USE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `database_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="ddl-表操作-查询" tabindex="-1">DDL-表操作-查询 <a class="header-anchor" href="#ddl-表操作-查询" aria-label="Permalink to &quot;DDL-表操作-查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW TABLES;                     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询当前数据库所有表</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询建表语句</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查询表结构</span></span></code></pre></div><h2 id="ddl-表操作-创建" tabindex="-1">DDL-表操作-创建 <a class="header-anchor" href="#ddl-表操作-创建" aria-label="Permalink to &quot;DDL-表操作-创建&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">table_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">` (</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    `field_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DATA_TYPE [COMMENT `field_1_comment`],</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    `field_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DATA_TYPE [COMMENT `field_2_comment`],</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...,</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    `field_n`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DATA_TYPE [COMMENT `field_n_comment`]</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) [COMMENT `table_comment`];</span></span></code></pre></div><h2 id="ddl-表操作-数据类型" tabindex="-1">DDL-表操作-数据类型 <a class="header-anchor" href="#ddl-表操作-数据类型" aria-label="Permalink to &quot;DDL-表操作-数据类型&quot;">​</a></h2><table><thead><tr><th>分类</th><th>类型</th><th>大小</th><th>描述</th></tr></thead><tbody><tr><td rowspan="7">数值类型</td><td>TINYINT</td><td>1 byte</td><td></td></tr><tr><td>SMALLINT</td><td>2 bytes</td><td></td></tr><tr><td>MEDIUMINT</td><td>3 bytes</td><td></td></tr><tr><td>INT / INTEGER</td><td>4 bytes</td><td></td></tr><tr><td>BIGINT</td><td>8 bytes</td><td></td></tr><tr><td>FLOAT</td><td>4 bytes</td><td></td></tr><tr><td>DOUBLE</td><td>8 bytes</td><td></td></tr><tr><td rowspan="10">字符串类型</td><td>CHAR</td><td>0 ~ 255 bytes</td><td>定长字符串</td></tr><tr><td>VARCHAR</td><td>0 ~ 65535 bytes</td><td>变长字符串</td></tr><tr><td>TINYBLOB</td><td>0 ~ 255 bytes</td><td></td></tr><tr><td>TINYTEXT</td><td>0 ~ 255 bytes</td><td></td></tr><tr><td>BLOB</td><td>0 ~ 65535 bytes</td><td>二进制的长文本数据</td></tr><tr><td>TEXT</td><td>0 ~ 65535 bytes</td><td>长文本数据</td></tr><tr><td>MEDIUMBLOB</td><td>0 ~ 16777215 bytes</td><td></td></tr><tr><td>MEDIUMTEXT</td><td>0 ~ 16777215 bytes</td><td></td></tr><tr><td>LONGBLOB</td><td>0 ~ 4294967295 bytes</td><td>二进制形式的极大文本数据</td></tr><tr><td>LONGTEXT</td><td>0 ~ 4294967295 bytes</td><td>极大文本数据</td></tr></tbody></table><h2 id="ddl-表操作-修改" tabindex="-1">DDL-表操作-修改 <a class="header-anchor" href="#ddl-表操作-修改" aria-label="Permalink to &quot;DDL-表操作-修改&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 添加字段</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ADD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [COMMENT `field_comment`];</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改字段类型</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> MODIFY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改字段名和类型</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CHANGE </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field`</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `new_field`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [COMMENT `field_comment`];</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除字段</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DROP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 修改表名</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RENAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `new_table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除表</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [IF EXISTS] </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除并重建表</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRUNCATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>使用 <code>TRUNCATE TABLE table_name</code>，表中数据会被清空</p></div><h2 id="dml-插入数据" tabindex="-1">DML-插入数据 <a class="header-anchor" href="#dml-插入数据" aria-label="Permalink to &quot;DML-插入数据&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 给全部字段添加数据</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...);</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 给指定字段添加数据</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...);</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 批量添加</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...), (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...), ...;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...), (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...), ...;</span></span></code></pre></div><h2 id="dml-修改数据" tabindex="-1">DML-修改数据 <a class="header-anchor" href="#dml-修改数据" aria-label="Permalink to &quot;DML-修改数据&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field_1`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`value_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ... [WHERE ...];</span></span></code></pre></div><h2 id="dml-删除数据" tabindex="-1">DML-删除数据 <a class="header-anchor" href="#dml-删除数据" aria-label="Permalink to &quot;DML-删除数据&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [WHERE ...];</span></span></code></pre></div><h2 id="dql-基础查询" tabindex="-1">DQL-基础查询 <a class="header-anchor" href="#dql-基础查询" aria-label="Permalink to &quot;DQL-基础查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field_1`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `alias_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_2`</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `alias_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- AS可省略</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT DISTINCT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 去重</span></span></code></pre></div><h2 id="dql-条件查询" tabindex="-1">DQL-条件查询 <a class="header-anchor" href="#dql-条件查询" aria-label="Permalink to &quot;DQL-条件查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>使用 <code>WHERE BETWEEN a AND b</code> 时，<code>a</code> 应当小于 <code>b</code></p></div><h2 id="dql-聚合函数" tabindex="-1">DQL-聚合函数 <a class="header-anchor" href="#dql-聚合函数" aria-label="Permalink to &quot;DQL-聚合函数&quot;">​</a></h2><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>COUNT</td><td>统计数量</td></tr><tr><td>MAX</td><td>最大值</td></tr><tr><td>MIN</td><td>最小值</td></tr><tr><td>AVG</td><td>平均值</td></tr><tr><td>SUM</td><td>求和</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>NULL</code> 不参与聚合运算</p></div><h2 id="dql-分组查询" tabindex="-1">DQL-分组查询 <a class="header-anchor" href="#dql-分组查询" aria-label="Permalink to &quot;DQL-分组查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [WHERE ...] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [HAVING ...];</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 例：查询 tb_user 中各地区三十岁以下用户数量大于 3 的所有地区</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `address`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `user_num`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_user`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `age`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `address`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HAVING</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `user_num`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>WHERE</code> 与 <code>HAVING</code> 的区别：</p><ul><li>执行时机不同：<code>WHERE</code> 分组前进行过滤，不满足条件的数据不参与分组；<code>HAVING</code> 是分组后对结果进行过滤。</li><li>判断条件不同：<code>WHERE</code> 不能对聚合函数判断，而 <code>HAVING</code> 可以。</li></ul></div><h2 id="dql-排序查询" tabindex="-1">DQL-排序查询 <a class="header-anchor" href="#dql-排序查询" aria-label="Permalink to &quot;DQL-排序查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 升序，默认值</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 降序</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `field_1`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`field_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 先对字段1进行升序排序，如果值相同则按字段2降序排序</span></span></code></pre></div><h2 id="dql-分页查询" tabindex="-1">DQL-分页查询 <a class="header-anchor" href="#dql-分页查询" aria-label="Permalink to &quot;DQL-分页查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page_num </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, page_size;</span></span></code></pre></div><h2 id="dql-执行顺序" tabindex="-1">DQL-执行顺序 <a class="header-anchor" href="#dql-执行顺序" aria-label="Permalink to &quot;DQL-执行顺序&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `addr`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 4</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_user`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `user`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              -- 1</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `age`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 40</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         -- 2</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `addr`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- 3</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`addr`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ASC</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- 5</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                           -- 6</span></span></code></pre></div><h2 id="函数-字符串" tabindex="-1">函数-字符串 <a class="header-anchor" href="#函数-字符串" aria-label="Permalink to &quot;函数-字符串&quot;">​</a></h2><table><thead><tr><th>函数</th><th>功能</th></tr></thead><tbody><tr><td><code>CONCAT(S1, S2, ..., Sn)</code></td><td>字符串拼接，将 <code>S1, S2, ..., Sn</code> 拼接成一个字符串</td></tr><tr><td><code>LOWER(str)</code></td><td>将字符串 <code>str</code> 转小写</td></tr><tr><td><code>UPPER(str)</code></td><td>将字符串 <code>str</code> 转大写</td></tr><tr><td><code>TRIM(str)</code></td><td>去掉字符串 <code>str</code> 首尾的空格</td></tr><tr><td><code>SUBSTRING(str, start, len)</code></td><td>返回字符串 <code>str</code> 从 <code>start</code> 开始的 <code>len</code> 长度的字符子串</td></tr><tr><td><code>LPAD(str, n, pad)</code></td><td>左填充，用字符串 <code>pad</code> 在 <code>str</code> 左边填充，直到 <code>str</code> 长度达到 <code>n</code></td></tr><tr><td><code>RPAD(str, n, pad)</code></td><td>右填充，用字符串 <code>pad</code> 在 <code>str</code> 右边填充，直到 <code>str</code> 长度达到 <code>n</code></td></tr></tbody></table><h2 id="函数-数值" tabindex="-1">函数-数值 <a class="header-anchor" href="#函数-数值" aria-label="Permalink to &quot;函数-数值&quot;">​</a></h2><table><thead><tr><th>函数</th><th>功能</th></tr></thead><tbody><tr><td><code>CEIL(x)</code></td><td>向上取整</td></tr><tr><td><code>FLOOR(x)</code></td><td>向下取整</td></tr><tr><td><code>MOD(x, y)</code></td><td>返回 <code>x / y</code> 的模</td></tr><tr><td><code>RAND()</code></td><td>返回 0 ~ 1 内的随机数</td></tr><tr><td><code>ROUND(x, y)</code></td><td>返回 <code>x</code> 的四舍五入值，保留 <code>y</code> 位小数</td></tr></tbody></table><h2 id="函数-流程" tabindex="-1">函数-流程 <a class="header-anchor" href="#函数-流程" aria-label="Permalink to &quot;函数-流程&quot;">​</a></h2><table><thead><tr><th>函数</th><th>功能</th></tr></thead><tbody><tr><td><code>IF(expr1, expr2, expr3)</code></td><td>如果 <code>expr1 = TRUE</code>，则返回 <code>expr2</code>，否则返回 <code>expr3</code></td></tr><tr><td><code>IFNULL(expr1, expr2)</code></td><td>如果 <code>expr1 IS NOT NULL</code>，则返回 <code>expr1</code>，否则返回 <code>expr2</code></td></tr><tr><td><code>CASE WHEN val THEN res ELSE default END</code></td><td>如果 <code>val = TRUE</code>，则返回 <code>res</code>，否则返回 <code>default</code></td></tr><tr><td><code>CASE t WHEN val THEN res ELSE default END</code></td><td>如果 <code>t = val</code>，则返回 <code>res</code>，否则返回 <code>default</code></td></tr></tbody></table><h2 id="约束" tabindex="-1">约束 <a class="header-anchor" href="#约束" aria-label="Permalink to &quot;约束&quot;">​</a></h2><table><thead><tr><th>约束</th><th>描述</th><th>关键字</th></tr></thead><tbody><tr><td>非空约束</td><td>字段值不能为 <code>NULL</code></td><td><code>NOT NULL</code></td></tr><tr><td>唯一约束</td><td>保证该字段的所有值都是不重复的</td><td><code>UNIQUE</code></td></tr><tr><td>主键约束</td><td>主键是一行数据的唯一标识，非空且唯一</td><td><code>PRIMART KEY</code></td></tr><tr><td>默认约束</td><td>插入数据时如未指定该字段值，则采用默认值</td><td><code>DEFAULT</code></td></tr><tr><td>检查约束</td><td>保证字段值满足条件 (MySQL8新特性)</td><td><code>CHECK</code></td></tr></tbody></table><h2 id="多表查询-内连接" tabindex="-1">多表查询-内连接 <a class="header-anchor" href="#多表查询-内连接" aria-label="Permalink to &quot;多表查询-内连接&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 隐式内连接</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`table_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显式内连接</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_1`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [INNER] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">JOIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 例：查询每一个员工的姓名和部门名称</span></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 表：tb_emp, tb_dept</span></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 连接条件：tb_emp.dept_id = tb_dept.id</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_emp`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`tb_dept`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_emp`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`tb_dept`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_emp`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`dept_id`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_dept`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`id`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 隐式</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_emp`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`name`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`tb_dept`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`name`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_emp`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INNER JOIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_dept`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_emp`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`dept_id`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `tb_dept`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`id`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 显式</span></span></code></pre></div><h2 id="多表查询-外连接" tabindex="-1">多表查询-外连接 <a class="header-anchor" href="#多表查询-外连接" aria-label="Permalink to &quot;多表查询-外连接&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_1`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LEFT  OUTER JOIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 左外连接</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_1`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RIGHT OUTER JOIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 右外连接</span></span></code></pre></div><h2 id="多表查询-自连接" tabindex="-1">多表查询-自连接 <a class="header-anchor" href="#多表查询-自连接" aria-label="Permalink to &quot;多表查询-自连接&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `alias_1`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INNER JOIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `alias_2`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>自连接可以是内连接也可以是外连接。</p></div><h2 id="多表查询-联合查询" tabindex="-1">多表查询-联合查询 <a class="header-anchor" href="#多表查询-联合查询" aria-label="Permalink to &quot;多表查询-联合查询&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_1`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ALL]</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `table_2`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>联合查询的列数与字段类型必须保持一致。</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>UNION ALL</code> 会把全部结果直接合并在一起，<code>UNION</code> 会对合并之后的数据去重。</p></div><h2 id="多表查询-子查询" tabindex="-1">多表查询-子查询 <a class="header-anchor" href="#多表查询-子查询" aria-label="Permalink to &quot;多表查询-子查询&quot;">​</a></h2><h3 id="标量子查询" tabindex="-1">标量子查询 <a class="header-anchor" href="#标量子查询" aria-label="Permalink to &quot;标量子查询&quot;">​</a></h3><p>子查询结果返回的是单个值（数字、字符串、日期等），最简单的形式，这种子查询称为 <strong>标量子查询</strong>。<br> 常用操作符：<code>=</code> <code>&lt;&gt;</code> <code>&gt;</code> <code>&lt;</code> <code>&gt;=</code> <code>&lt;=</code></p><h3 id="列子查询" tabindex="-1">列子查询 <a class="header-anchor" href="#列子查询" aria-label="Permalink to &quot;列子查询&quot;">​</a></h3><p>子查询结果返回的是一列，这种子查询称为 <strong>列子查询</strong>。<br> 常用操作符：<code>IN</code> <code>NOT IN</code> <code>ANY</code> <code>SOME</code> <code>ALL</code></p><table><thead><tr><th>操作符</th><th>描述</th></tr></thead><tbody><tr><td><code>IN</code></td><td>在指定集合范围之内，多选一</td></tr><tr><td><code>NOT IN</code></td><td>不在指定集合范围之内</td></tr><tr><td><code>ANY</code></td><td>子查询返回列表中，在一个任意满足即可</td></tr><tr><td><code>SOME</code></td><td>与 <code>ANY</code> 等同，使用 <code>SOME</code> 的地方都可以用 <code>ANY</code></td></tr><tr><td><code>ALL</code></td><td>子查询返回列表的所有值都必须满足</td></tr></tbody></table><h3 id="行子查询" tabindex="-1">行子查询 <a class="header-anchor" href="#行子查询" aria-label="Permalink to &quot;行子查询&quot;">​</a></h3><p>子查询结果返回的是一行，这种子查询称为 <strong>列子查询</strong>。<br> 常用操作符：<code>IN</code> <code>NOT IN</code> <code>=</code> <code>&lt;&gt;</code></p><h3 id="表子查询" tabindex="-1">表子查询 <a class="header-anchor" href="#表子查询" aria-label="Permalink to &quot;表子查询&quot;">​</a></h3><p>子查询结果返回的是多行多列，这种子查询称为 <strong>表子查询</strong>。<br> 常用操作符：<code>IN</code></p><h2 id="事务-操作" tabindex="-1">事务-操作 <a class="header-anchor" href="#事务-操作" aria-label="Permalink to &quot;事务-操作&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 自动提交</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@AUTOCOMMIT;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查看提交方式</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@AUTOCOMMIT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 关闭自动提交</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@AUTOCOMMIT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 开启自动提交</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 事务操作</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 开启事务</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">START TRANSACTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 开启事务</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 提交事务</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 回滚事务</span></span></code></pre></div><h2 id="事务-四大特性" tabindex="-1">事务-四大特性 <a class="header-anchor" href="#事务-四大特性" aria-label="Permalink to &quot;事务-四大特性&quot;">​</a></h2><ul><li>原子性（Atomicity）：事务是不可分割的最小单元，要么全部成功，要么全部失败。</li><li>一致性（Consistency）：事务完成时，必须所有数据都保持一致状态。</li><li>隔离性（Isolation）：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行。</li><li>持久性（Durability）：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</li></ul><h2 id="事务-并发问题" tabindex="-1">事务-并发问题 <a class="header-anchor" href="#事务-并发问题" aria-label="Permalink to &quot;事务-并发问题&quot;">​</a></h2><table><thead><tr><th>问题</th><th>描述</th></tr></thead><tbody><tr><td>脏读</td><td>一个事务读到另一个事务还没有提交的数据</td></tr><tr><td>不可重复读</td><td>一个事务先后读取同一条记录，但两次读取的数据不同</td></tr><tr><td>幻读</td><td>一个事务按照条件查询数据时，没有对应的数据行，但是在插入时，又发现这行数据存在</td></tr></tbody></table><h2 id="事务-隔离级别" tabindex="-1">事务-隔离级别 <a class="header-anchor" href="#事务-隔离级别" aria-label="Permalink to &quot;事务-隔离级别&quot;">​</a></h2><table><thead><tr><th>隔离级别</th><th style="text-align:center;">脏读</th><th style="text-align:center;">不可重复读</th><th style="text-align:center;">幻读</th></tr></thead><tbody><tr><td>read uncommitted</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td></tr><tr><td>read committed</td><td style="text-align:center;">×</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td></tr><tr><td>repeatable read（默认）</td><td style="text-align:center;">×</td><td style="text-align:center;">×</td><td style="text-align:center;">√</td></tr><tr><td>serializable</td><td style="text-align:center;">×</td><td style="text-align:center;">×</td><td style="text-align:center;">×</td></tr></tbody></table><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查看事务隔离级别</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@TRANSACTION_ISOLATION;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 设置事务隔离级别</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SESSION | GLOBAL] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRANSACTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ISOLATION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LEVEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE]</span></span></code></pre></div><h2 id="存储引擎" tabindex="-1">存储引擎 <a class="header-anchor" href="#存储引擎" aria-label="Permalink to &quot;存储引擎&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW ENGINES;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查看所有引擎</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">`(...) ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">INNODB;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 设置存储引擎</span></span></code></pre></div><table><thead><tr><th>InnoDB</th><th>MyISAM</th></tr></thead><tbody><tr><td>支持事务</td><td>不支持事务</td></tr><tr><td>支持外键</td><td>不支持外键</td></tr><tr><td>支持行级锁</td><td>支持表级锁</td></tr></tbody></table><ul><li>InnoDB：MySQL 默认的存储引擎。如果对事务、数据一致性有高要求，InnoDB 比较合适。</li><li>MyISAM：如果以查询和插入为主，很少更新和删除，可以选用 MyISAM。例如：日志的存储。</li><li>Memory：将数据保存再内存中，访问速度快。</li></ul><p>实际上，绝大部分场景都是 InnoDB，另外两种都被别的 NoSQL 数据库替代了。例如：用 MangoDB 替代 MyISAM，Redis 替代 Memory。</p><p>InnoDB逻辑存储结构：<br><img src="'+d+`" alt="Innodb Structure"></p><h2 id="索引-分类" tabindex="-1">索引-分类 <a class="header-anchor" href="#索引-分类" aria-label="Permalink to &quot;索引-分类&quot;">​</a></h2><table><thead><tr><th>分类</th><th>含义</th><th>特点</th><th>关键字</th></tr></thead><tbody><tr><td>主键索引</td><td>针对表中主键创建的索引</td><td>默认创建，只能有一个</td><td><code>PRIMARY</code></td></tr><tr><td>唯一索引</td><td>同一个表中某字段的值不重复</td><td>可以有多个</td><td><code>UNIQUE</code></td></tr><tr><td>常规索引</td><td>快速查找特定数据</td><td>可以有多个</td><td></td></tr><tr><td>全文索引</td><td>查找的是文本中的关键字，而不是索引的值</td><td>可以有多个</td><td><code>FULLTEXT</code></td></tr></tbody></table><p>在 InnoDB 存储引擎中，根据索引的存储形式，又可以分为以下几种：</p><table><thead><tr><th>分类</th><th>含义</th><th>特点</th></tr></thead><tbody><tr><td>聚集索引</td><td>将数据存储和索引放到一块，索引结构的叶子节点保存了行数据</td><td>必须有，且只有一个</td></tr><tr><td>二级索引</td><td>将数据和索引分开存储，索引结构的叶子节点关联的是对应的主键</td><td>可以存在多个</td></tr></tbody></table><p>聚集索引选取规则：</p><ul><li>如果存在主键，主键索引就是聚集索引</li><li>如果不存在主键，将使用第一个唯一(UNIQUE)索引作为聚集索引。</li><li>如果没有主键和合适的唯一索引，则 InnoDB 会自动生成的一个 <code>rowid</code> 作为隐藏的聚集索引。</li></ul><h2 id="索引-语法" tabindex="-1">索引-语法 <a class="header-anchor" href="#索引-语法" aria-label="Permalink to &quot;索引-语法&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [UNIQUE|FULLTEXT] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INDEX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`index_name\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`table_name\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`field\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 查看索引</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INDEX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`table_name\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 删除索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`index_name\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`table_name\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="索引-性能分析" tabindex="-1">索引-性能分析 <a class="header-anchor" href="#索引-性能分析" aria-label="Permalink to &quot;索引-性能分析&quot;">​</a></h2><ul><li><strong>SQL执行频率</strong></li></ul><p>通过 <code>SHOW [SESSION|GLOBAL] STATUS</code> 指令可以提供服务器状态信息。可在此基础上通过 <code>LIKE</code> 匹配出增删改查的频次信息，如：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SESSION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> STATUS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Com_______&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 输出：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- +---------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Variable_name | Value |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- +---------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_binlog    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_commit    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_delete    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_import    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_insert    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_repair    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_revoke    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_select    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_signal    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_update    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Com_xa_end    | 0     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- +---------------+-------+</span></span></code></pre></div><p>其中，增删改查的频次分别对应表中的 <code>Com_insert</code>、<code>Com_delete</code>、<code>Com_update</code>、<code>Com_select</code> 的值。</p><ul><li><strong>慢查询日志</strong></li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@slow_query_log;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 慢查询日志开关，0-关闭，1-开启</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@slow_query_log_file;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 慢查询日志所在文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @@long_query_time;      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 单位：秒。SQL执行时间超过该值就会被记入慢查询日志</span></span></code></pre></div><p>以上变量可以前往 MySQL 的配置文件 <code>my.ini</code>(Windows) / <code>my.cnf</code>(Linux) 进行修改：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>slow-query-log=1</span></span>
<span class="line"><span>slow_query_log_file=&quot;slow.log&quot;</span></span>
<span class="line"><span>long_query_time=10</span></span></code></pre></div><ul><li><strong>profile</strong></li></ul><p><code>SHOW PROFILES</code> 能够帮助我们在做 SQL 优化时了解每句 SQL 的执行时间。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW VARIABLES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;%profiling%&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- +------------------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | Variable_name          | Value |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- +------------------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | have_profiling         | YES   |  -- 当前 MySQL 是否支持 profile 操作</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | profiling              | OFF   |  -- 默认关闭，可以通过 SET 语句开启</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- | profiling_history_size | 15    |  -- SQL 最近执行的记录数量</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- +------------------------+-------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> profiling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 开启 profiles 操作</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW PROFILES;</span></span></code></pre></div><ul><li><strong>EXPLAIN 执行计划</strong></li></ul><p><code>EXPLAIN</code> 或者 <code>DESC</code> 命令可查看 MySQL 如何执行 SQL 的信息。返回的信息如下：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+----+-------------+---------+------+---------------+------+---------+------+----------+-------+</span></span>
<span class="line"><span>| id | select_type | table   | type | possible_keys | key  | key_len | rows | filtered | Extra |</span></span>
<span class="line"><span>+----+-------------+---------+------+---------------+------+---------+------+----------+-------+</span></span>
<span class="line"><span>|  1 | SIMPLE      | tb_user | ALL  | NULL          | NULL | NULL    |    1 |   100.00 | NULL  |</span></span>
<span class="line"><span>+----+-------------+---------+------+---------------+------+---------+------+----------+-------+</span></span></code></pre></div><p><code>EXPLAIN</code> 执行计划各字段含义：</p><ul><li><code>id</code>：<code>SELECT 查询</code> 的序列号，表示查询中执行 <code>SELECT 子句</code> 或表连接的顺序（<code>id</code> 相同，执行顺序从上到下；<code>id</code> 不同，值越大，越先执行）。</li><li><code>select_type</code>：表示 <code>SELECT</code> 的类型，常见的取值有：<code>SIMPLE</code>（简单表，即不使用子查询和表连接）、<code>SUBQUERY</code>（<code>SELECT</code> / <code>WHERE</code> 之后包含了子查询）等。</li><li><code>type</code>：连接类型。性能由好到差分别为：<code>NULL</code>(不连接表), <code>SYSTEM</code>(访问系统表), <code>const</code>(根据主键或唯一索引访问), <code>ref</code>(使用非唯一索引), <code>RANGE</code>(使用非唯一索引，但是进行了范围匹配), <code>INDEX</code>(遍历整个索引树), <code>ALL</code>(全表扫描)。</li><li><code>possible_keys</code>：可能用到的索引，一个或多个。</li><li><code>key</code>：实际用到的索引。</li><li><code>key_len</code>：索引中使用的字节数，该值为最大可能长度，并非实际使用长度。该值越短越好。</li><li><code>rows</code>：MySQL 认为必须要查询的行数，在 InnoDB 中为估计值，并不总是准确的。</li><li><code>filtered</code>：返回结果的行数占读取行数的百分比，越大越好。</li></ul><h2 id="索引-使用规则" tabindex="-1">索引-使用规则 <a class="header-anchor" href="#索引-使用规则" aria-label="Permalink to &quot;索引-使用规则&quot;">​</a></h2><ul><li><strong>最左前缀法则</strong></li></ul>`,108),o=i("ul",null,[i("li",null,[i("strong",null,"范围查询")])],-1),g=i("code",null,"<",-1),c=i("code",null,">",-1),y=i("ul",null,[i("li",null,[i("strong",null,"索引列运算")])],-1),F=n(`<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 要求：查询手机号以166开头的用户</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 表：tb_user, 索引：idx_user_phone(建立在phone字段上的索引)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 索引列发生计算，索引失效</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tb_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SUBSTRING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`phone\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;166&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 使用模糊查询代替了索引列的计算，索引生效</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tb_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`phone\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;166%&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li><strong>字符串不加引号</strong></li></ul>`,2),A=n(`<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 表: tb_user, 字段: phone(字符串类型, 有索引)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tb_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  166888</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 索引失效</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tb_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;166888&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 索引有效</span></span></code></pre></div><ul><li><strong>模糊查询</strong></li></ul>`,2),D=n(`<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 表: tb_user, 字段: phone(字符串类型, 有索引)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tb_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;%888&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 索引失效</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tb_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;166%&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 索引有效</span></span></code></pre></div>`,1);function b(u,C,_,m,T,B){const a=e("font");return p(),k("div",null,[E,i("p",null,[s("使用联合索引要遵守最左前缀法则，即从索引的最左列开始，依次生效。如果某一列不匹配，"),t(a,{color:"red"},{default:l(()=>[s("索引将部分失效")]),_:1}),s("（后面的索引列无效）。")]),o,i("p",null,[s("联合索引中，出现 "),g,s(" 或 "),c,s(" 等范围查询，会导致后面的"),t(a,{color:"red"},{default:l(()=>[s("索引列失效")]),_:1}),s("。")]),y,i("p",null,[s("在索引列上运算将导致"),t(a,{color:"red"},{default:l(()=>[s("索引失效")]),_:1}),s("。")]),F,i("p",null,[s("字符串类型的字段数值不加引号，"),t(a,{color:"red"},{default:l(()=>[s("索引失效")]),_:1}),s("。")]),A,i("p",null,[s("尾部模糊匹配，索引有效。头部模糊匹配，"),t(a,{color:"red"},{default:l(()=>[s("索引失效")]),_:1}),s("。")]),D])}const S=h(r,[["render",b]]);export{v as __pageData,S as default};
